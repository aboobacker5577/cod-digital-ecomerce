"use strict";(self.webpackChunkCARDS_RECHARGE=self.webpackChunkCARDS_RECHARGE||[]).push([[848],{2848:(A,m,l)=>{l.r(m),l.d(m,{RatePlanModule:()=>C});var u=l(6814),c=l(7553),t=l(6689),g=l(5570),i=l(95),d=l(8596),f=l(8448);function h(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",12)(1,"select",23),t.NdJ("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changePageSize())})("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.pageSize=n)}),t.TgZ(2,"option",24),t._uU(3,"10"),t.qZA(),t.TgZ(4,"option",24),t._uU(5,"50"),t.qZA(),t.TgZ(6,"option",24),t._uU(7,"100"),t.qZA(),t.TgZ(8,"option",24),t._uU(9,"500"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.pageSize),t.xp6(1),t.Q6J("value",10),t.xp6(2),t.Q6J("value",50),t.xp6(2),t.Q6J("value",100),t.xp6(2),t.Q6J("value",500)}}function _(a,r){1&a&&t._UZ(0,"input",25)}const P=function(a){return{"":a}};function R(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",26)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"img",27),t._uU(5),t.qZA(),t.TgZ(6,"td")(7,"span"),t._uU(8),t.qZA()(),t.TgZ(9,"td")(10,"input",28),t.NdJ("input",function(n){const p=t.CHM(e).index,x=t.oxw();return t.KtG(x.editRow(n,p))}),t.qZA()(),t.TgZ(11,"td")(12,"span"),t._uU(13),t.qZA()(),t.TgZ(14,"td"),t._UZ(15,"input",29),t.TgZ(16,"label",30),t.NdJ("label",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.activeText)}),t.qZA()()()}if(2&a){const e=r.$implicit,o=r.index;t.Q6J("formGroupName",o)("ngClass",t.VKq(9,P,"active"==e.value.status)),t.xp6(2),t.Oqu(o+1),t.xp6(2),t.s9C("src",e.value.img,t.LSH),t.xp6(1),t.hij(" ",e.value.product," "),t.xp6(3),t.Oqu(e.value.purchase_rate),t.xp6(5),t.Oqu(e.value.selling_rate),t.xp6(2),t.Q6J("disabled",!0)("checked","active"==e.value.status)}}function T(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"app-pagination",31),t.NdJ("goTo",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onGoTo(n))}),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("pageNumber",e.pageNumber)("pageSize",e.pageSize)("total",e.totalCount)}}const b=[{path:"",component:(()=>{class a{constructor(e,o,n,s){this._ar=e,this.API=o,this.fb=n,this.Toaster=s,this.pageNumber=1,this.totalCount=0,this.loadPagination=!1,this.pageSize=50,this.ratePlanList=[],this.activeText="ON",this.productId=null,this.productDetails=null,this.imgUrl=null,this.customerId=null,this.initRatePlanForm()}ngOnInit(){this.imgUrl=this.API.GET_IMG_URL(),this._ar.queryParams.subscribe(e=>{this.customerId=e.cus,this.getRatePlan()})}onGoTo(e){this.pageNumber=e}changePageSize(){this.loadPagination=!1,this.pageNumber=1}getRatePlan(){this.API.GET("/rateplan",{user_id:this.customerId}).subscribe(e=>{if(e.success){let o=e.data.rate_plans;this.ratePlan.clear();for(let n of o)this.ratePlan.push(this.newRateDaynamic(n))}})}initRatePlanForm(){this.frmRatePlan=this.fb.group({ratePlan:this.fb.array([])})}get ratePlan(){return this.frmRatePlan.get("ratePlan")}newRate(){return this.fb.group({img:"",product:"",product_id:"",purchase_rate:"",profit:"",selling_rate:"",status:""})}addRate(){this.ratePlan.push(this.newRate())}newRateDaynamic(e){return this.fb.group({img:this.imgUrl+"/"+e.image,product:e.name,product_id:e.id,purchase_rate:e.parent_total_rate,profit:e.cashbacks_for_me?e.cashbacks_for_me:0,selling_rate:e.user_final_purchase_rate,status:e.status})}removeRates(e){this.ratePlan.removeAt(e)}onSubmit(e){console.log(e);let o={user_id:this.customerId,profits:e.ratePlan.map(n=>({product_id:n.product_id,profit:n.profit}))};this.API.POST("/rateplan",o).subscribe(n=>{n.success?(this.Toaster.Success("x",n.message),this.getRatePlan()):this.Toaster.Error("x",n.message)})}triggerSubmitButton(){document.getElementById("btnSubmit")?.click()}editRow(e,o){const n=this.frmRatePlan.controls.ratePlan;let p=e.target.value;n.value[o].selling_rate=Number(n.value[o].purchase_rate)+Number(p)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(c.gz),t.Y36(g.M),t.Y36(i.qu),t.Y36(d.M))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-rate-plan"]],decls:41,vars:5,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"toplogo"],[1,"d-flex"],[1,"flex-grow-1","align-self-center"],[1,"font-size-14","m-0"],[1,"text-muted"],[1,"btn","btn-outline-success","waves-effect","waves-light","floating-new-button",3,"click"],["class","col-md-2 pb-3",4,"ngIf"],[1,"col-md-8","pb-3"],[1,"col-md-2","pb-3"],["type","text","class","form-control","placeholder","Search",4,"ngIf"],[1,"table-rep-plugin"],[3,"formGroup","ngSubmit"],[1,"table-wrapper"],["data-pattern","priority-columns",1,"table-responsive","mb-0","fixed-solution"],["id","tech-companies-1",1,"table","table-striped"],["formArrayName","ratePlan"],[3,"formGroupName","ngClass",4,"ngFor","ngForOf"],[3,"pageNumber","pageSize","total","goTo",4,"ngIf"],["id","btnSubmit","type","submit",1,"hide",2,"visibility","hidden"],[1,"form-control",3,"ngModel","change","ngModelChange"],[3,"value"],["type","text","placeholder","Search",1,"form-control"],[3,"formGroupName","ngClass"],["alt","",1,"rounded-circle","avatar-sm",3,"src"],["type","number","formControlName","profit",1,"form-control",3,"input"],["type","checkbox","id","switch4","switch","success",3,"disabled","checked"],["for","switch4","data-off-label","OFF",3,"label"],[3,"pageNumber","pageSize","total","goTo"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h4",7),t._uU(8,"Rate Plan"),t.qZA(),t.TgZ(9,"small",8),t._uU(10,"Customer"),t.qZA()()(),t.TgZ(11,"button",9),t.NdJ("click",function(){return o.triggerSubmitButton()}),t._uU(12," SAVE "),t.qZA()(),t.TgZ(13,"div",0),t.YNc(14,h,10,5,"div",10),t._UZ(15,"div",11),t.TgZ(16,"div",12),t.YNc(17,_,1,0,"input",13),t.qZA()(),t.TgZ(18,"div",14)(19,"form",15),t.NdJ("ngSubmit",function(){return o.onSubmit(o.frmRatePlan.value)}),t.TgZ(20,"div",16)(21,"div",17)(22,"table",18)(23,"thead")(24,"tr")(25,"th"),t._uU(26,"SLNO"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"PRODUCT"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"PURCHASE RATE"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"PROFIT"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"SELLING RATE"),t.qZA(),t.TgZ(35,"th"),t._uU(36,"STATUS"),t.qZA()()(),t.TgZ(37,"tbody",19),t.YNc(38,R,17,11,"tr",20),t.qZA()()(),t.YNc(39,T,1,3,"app-pagination",21),t._UZ(40,"button",22),t.qZA()()()()()()()),2&e&&(t.xp6(14),t.Q6J("ngIf",!1),t.xp6(3),t.Q6J("ngIf",!1),t.xp6(2),t.Q6J("formGroup",o.frmRatePlan),t.xp6(19),t.Q6J("ngForOf",o.frmRatePlan.controls.ratePlan.controls),t.xp6(1),t.Q6J("ngIf",o.loadPagination))},dependencies:[u.mk,u.sg,u.O5,f.Q,i._Y,i.YN,i.Kr,i.Fj,i.wV,i.EJ,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,i.On]}),a})()}];let v=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[c.Bz.forChild(b),c.Bz]}),a})();var Z=l(1383);let C=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.ez,v,Z.m]}),a})()}}]);